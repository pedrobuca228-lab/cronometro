<!DOCTYPE html>
<html lang="pt-PT">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cron√≥metro</title>

<!-- üîó Manifesto PWA -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#2196f3">

<style>
:root {
  --bg: #222d3e;
  --card: #201e1e;
  --accent: #1506ec;
  --text: #e6eef6;
  --muted: #a0a8b8;
}

body {
  margin: 0;
  background: var(--bg);
  color: var(--text);
  font-family: "Segoe UI", Arial, sans-serif;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100vh;
  overflow: hidden;
}

.container {
  background: var(--card);
  border-radius: 25px;
  padding: 50px;
  text-align: center;
  box-shadow: 0 0 50px rgba(0,0,0,0.6);
  width: 85%;
  max-width: 900px;
}

h1 {
  font-size: 60px;
  margin-bottom: 40px;
  color: var(--accent);
  text-transform: uppercase;
  letter-spacing: 2px;
}

#time {
  font-size: 120px;
  font-weight: bold;
  margin: 40px 0;
  letter-spacing: 3px;
}

.controls {
  display: flex;
  justify-content: center;
  gap: 30px;
  flex-wrap: wrap;
}

button {
  font-size: 36px;
  background: transparent;
  color: var(--text);
  border: 4px solid var(--accent);
  border-radius: 20px;
  padding: 20px 60px;
  cursor: pointer;
  transition: all 0.2s ease;
  font-weight: 700;
}

button:hover, button:focus {
  background: var(--accent);
  color: #000;
  transform: scale(1.05);
}

button.selected {
  outline: 5px solid var(--accent);
}

input[type="number"] {
  background: var(--card);
  color: var(--text);
  border: 4px solid var(--accent);
  border-radius: 15px;
  font-size: 36px;
  padding: 15px 25px;
  margin: 10px;
  width: 150px;
  text-align: center;
}

input.selected {
  outline: 5px solid var(--accent);
}

.footer {
  margin-top: 30px;
  font-size: 24px;
  color: var(--muted);
}
</style>
</head>
<body>
<div class="container">
  <h1>Cron√≥metro</h1>

  <div>
    <input type="number" id="minutes" placeholder="Minutos" min="0" max="59">
    <input type="number" id="seconds" placeholder="Segundos" min="0" max="59">
  </div>

  <div id="time">00m : 00s</div>

  <div class="controls">
    <button id="startBtn">Iniciar</button>
    <button id="pauseBtn">Pausar</button>
    <button id="resetBtn">Reiniciar</button>
  </div>

  <div class="footer"></div>
</div>

<audio id="alarmSound" src="alarm.mp3" preload="auto"></audio>

<script>
let countdown;
let remainingMs = 0;
let paused = false;
let started = false;

const display = document.getElementById("time");
const alarm = document.getElementById("alarmSound");

const minutesInput = document.getElementById("minutes");
const secondsInput = document.getElementById("seconds");

const startBtn = document.getElementById("startBtn");
const pauseBtn = document.getElementById("pauseBtn");
const resetBtn = document.getElementById("resetBtn");

// Elementos foc√°veis para TV/teclado (inputs + bot√µes)
const focusableElements = [minutesInput, secondsInput, startBtn, pauseBtn, resetBtn];
let focusedIndex = 0;

function formatTime(ms) {
  const totalSeconds = Math.max(0, Math.floor(ms / 1000));
  const minutes = String(Math.floor(totalSeconds / 60)).padStart(2, "0");
  const seconds = String(totalSeconds % 60).padStart(2, "0");
  return `${minutes}m : ${seconds}s`;
}

function updateDisplay() {
  display.textContent = formatTime(remainingMs);
  if (remainingMs <= 0) {
    clearInterval(countdown);
    alarm.play();
    started = false;
    paused = false;
    pauseBtn.textContent = "Pausar";
  }
}

function startTimer() {
  if (!started) {
    const m = parseInt(minutesInput.value) || 0;
    const s = parseInt(secondsInput.value) || 0;

    remainingMs = (m * 60 + s) * 1000;

    if (remainingMs <= 0) {
      alert("Defina um tempo v√°lido!");
      return;
    }

    started = true;
    paused = false;
    pauseBtn.textContent = "Pausar";
  }

  clearInterval(countdown);
  countdown = setInterval(() => {
    if (!paused && remainingMs > 0) {
      remainingMs -= 1000;
      updateDisplay();
    }
  }, 1000);
}

function pauseTimer() {
  if (!started) return;
  paused = !paused;
  pauseBtn.textContent = paused ? "Continuar" : "Pausar";
}

function resetTimer() {
  clearInterval(countdown);
  remainingMs = 0;
  started = false;
  paused = false;
  display.textContent = "00m : 00s";
  pauseBtn.textContent = "Pausar";
  minutesInput.value = "";
  secondsInput.value = "";
}

// Bot√µes
startBtn.addEventListener("click", startTimer);
pauseBtn.addEventListener("click", pauseTimer);
resetBtn.addEventListener("click", resetTimer);

// Fun√ß√£o para focar elementos TV/teclado
function focusElement(index) {
  focusableElements.forEach((el, i) => el.classList.toggle("selected", i === index));
  focusableElements[index].focus();
}

// Navega√ß√£o TV / teclado
document.addEventListener("keydown", (e) => {
  if (e.key === "ArrowRight" || e.key === "End") {
    focusedIndex = (focusedIndex + 1) % focusableElements.length;
    focusElement(focusedIndex);
  } else if (e.key === "ArrowLeft" || e.key === "Home") {
    focusedIndex = (focusedIndex - 1 + focusableElements.length) % focusableElements.length;
    focusElement(focusedIndex);
  } else if (e.key === "Enter") {
    const focusedEl = focusableElements[focusedIndex];
    if (focusedEl.tagName === "BUTTON") {
      focusedEl.click();
    }
  }
});

// Inicializa foco
focusElement(focusedIndex);
display.textContent = "00m : 00s";
</script>

<!-- üîß Registro do Service Worker -->
<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/cronometro/service-worker.js')
    .then(() => console.log('Service Worker registrado com sucesso.'))
    .catch(err => console.error('Falha ao registrar o Service Worker:', err));
}
</script>

</body>
</html>

